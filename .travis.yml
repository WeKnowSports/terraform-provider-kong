language: go
go:
  - 1.8.x
services:
  - docker
before_install:
  - curl -L https://releases.hashicorp.com/terraform/0.9.6/terraform_0.9.6_linux_amd64.zip > terraform.zip && unzip terraform.zip -d terraform && export PATH=$PATH:$PWD/terraform && echo $(terraform --version)
  - curl -L https://storage.googleapis.com/golang/go1.8.3.linux-amd64.tar.gz > go.tar.gz && tar -xzf go.tar.gz && export PATH=$PWD/go/bin:$PATH && echo $(go version)
  - export GOPATH=$HOME/gocode
  - export PATH=$PATH:$GOPATH/bin
install:
  - go get github.com/dghubble/sling
  - go get github.com/hashicorp/terraform/helper/schema
  - go get github.com/hashicorp/terraform/terraform
  - go get github.com/hashicorp/terraform/plugin
script:
  - docker-compose up -d
  - sleep 1m
  - ./init.sh apply
  - ./start.sh apply